(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{1152:function(e,t,s){Promise.resolve().then(s.bind(s,133))},133:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var r=s(7437),a=s(2265),n=s(4033),i=s(1865),o=s(8110),d=s(2160),c=s(3588),l=s(1396),u=s.n(l),h=s(5925),p=s(8222);let m=d.Ry({username:d.Z_().min(1,"Username is required"),password:d.Z_().min(1,"Password is required")});function g(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)(!1),{register:d,handleSubmit:l,formState:{errors:g}}=(0,i.cI)({resolver:(0,o.F)(m)}),y=(0,c.D)({mutationFn:e=>p.x.login(e),onSuccess:t=>{localStorage.setItem("access_token",t.access_token),h.ZP.success("Login successful!"),e.push("/")},onError:e=>{var t,s;h.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Login failed")}}),x=async e=>{s(!0);try{await y.mutateAsync(e)}finally{s(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Sign in to your account"}),(0,r.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:["Or"," ",(0,r.jsx)(u(),{href:"/auth/register",className:"font-medium text-primary hover:text-primary/80",children:"create a new account"})]})]}),(0,r.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:l(x),children:[(0,r.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"username",className:"sr-only",children:"Username"}),(0,r.jsx)("input",{...d("username"),id:"username",type:"text",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white rounded-t-md focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm bg-white dark:bg-gray-800",placeholder:"Username"}),g.username&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.username.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,r.jsx)("input",{...d("password"),id:"password",type:"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white rounded-b-md focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm bg-white dark:bg-gray-800",placeholder:"Password"}),g.password&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.password.message})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",disabled:t,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Signing in...":"Sign in"})})]})]})})}},8222:function(e,t,s){"use strict";s.d(t,{x:function(){return i}});var r=s(4829);let a=s(2601).env.NEXT_PUBLIC_API_URL||"http://localhost:8000";class n{generateKey(e){let{method:t,url:s,params:r,data:a}=e;return"".concat((null==t?void 0:t.toUpperCase())||"GET",":").concat(s,":").concat(JSON.stringify(r||{}),":").concat(JSON.stringify(a||{}))}isExpired(e){return Date.now()-e.timestamp>this.ttl}getCachedResponse(e){let t=this.cache.get(e);return t?this.isExpired(t)?(this.cache.delete(e),null):t:null}setCachedResponse(e,t,s){this.cache.set(e,{response:t,timestamp:Date.now(),promise:s})}clearExpired(){for(let[e,t]of this.cache.entries())this.isExpired(t)&&this.cache.delete(e)}async deduplicatedRequest(e){let t=this.generateKey(e),s=this.getCachedResponse(t);if(s)return s.promise?(this.stats.concurrent++,s.promise):(this.stats.hits++,s.response);this.stats.misses++;let r=this.client.request(e).then(e=>(this.setCachedResponse(t,e.data),e.data)).catch(e=>{throw this.cache.delete(t),e});return this.setCachedResponse(t,null,r),r}getDeduplicationStats(){return{...this.stats}}clearCache(){this.cache.clear()}async register(e){return this.deduplicatedRequest({method:"post",url:"/auth/register",data:e})}async login(e){return this.deduplicatedRequest({method:"post",url:"/auth/login",data:e})}async getCurrentUser(){return this.deduplicatedRequest({method:"get",url:"/auth/me"})}async updateProfile(e){return this.deduplicatedRequest({method:"put",url:"/auth/me",data:e})}async changePassword(e,t){return this.deduplicatedRequest({method:"post",url:"/auth/change-password",data:{old_password:e,new_password:t}})}async forgotPassword(e){return this.deduplicatedRequest({method:"post",url:"/auth/forgot-password",data:e})}async resetPassword(e){return this.deduplicatedRequest({method:"post",url:"/auth/reset-password",data:e})}async research(e){return this.deduplicatedRequest({method:"get",url:"/research",params:{query:e}})}async getUsers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return this.deduplicatedRequest({method:"get",url:"/admin/users",params:{skip:e,limit:t}})}async updateUserRole(e,t){return this.deduplicatedRequest({method:"put",url:"/admin/users/".concat(e,"/role"),data:{new_role:t}})}async healthCheck(){return this.deduplicatedRequest({method:"get",url:"/"})}constructor(e=3e5){this.client=r.Z.create({baseURL:a,headers:{"Content-Type":"application/json"}}),this.cache=new Map,this.ttl=e,this.stats={hits:0,misses:0,concurrent:0},this.client.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/auth/login"),Promise.reject(e)})}}let i=new n}},function(e){e.O(0,[517,829,251,797,971,938,744],function(){return e(e.s=1152)}),_N_E=e.O()}]);